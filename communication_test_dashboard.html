<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4DX@HOME é€šä¿¡ãƒ†ã‚¹ãƒˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .test-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #0056b3;
        }
        
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #1e7e34;
        }
        
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .results-container {
            margin-top: 20px;
        }
        
        .log-output {
            background-color: #1e1e1e;
            color: #ffffff;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            border: 1px solid #ccc;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-success {
            background-color: #28a745;
        }
        
        .status-error {
            background-color: #dc3545;
        }
        
        .status-warning {
            background-color: #ffc107;
        }
        
        .status-info {
            background-color: #17a2b8;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007bff, #28a745);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .test-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #007bff;
        }
        
        .session-info {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #90caf9;
        }
        
        .error-message {
            background-color: #ffebee;
            color: #c62828;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #ef9a9a;
        }
        
        .success-message {
            background-color: #e8f5e8;
            color: #2e7d32;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #a5d6a7;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¬ 4DX@HOME é€šä¿¡ãƒ†ã‚¹ãƒˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
            <p>Cloud Runç’°å¢ƒã§ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒ‡ãƒã‚¤ã‚¹é–“é€šä¿¡ãƒ†ã‚¹ãƒˆ</p>
            <div class="session-info">
                <strong>ãƒ†ã‚¹ãƒˆç’°å¢ƒ:</strong> https://fourdk-backend-333203798555.asia-northeast1.run.app
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ–¥ï¸ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é€šä¿¡ãƒ†ã‚¹ãƒˆ</h2>
            <div class="test-controls">
                <button class="btn btn-primary" onclick="runFrontendHealthCheck()">ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯</button>
                <button class="btn btn-success" onclick="runFrontendComprehensiveTest()">åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
                <button class="btn btn-danger" onclick="clearFrontendLog()">ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="frontend-progress"></div>
            </div>
            <div class="log-output" id="frontend-log"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ¤– ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰</h2>
            <div class="test-controls">
                <button class="btn btn-primary" onclick="runDeviceRegistration()">ãƒ‡ãƒã‚¤ã‚¹ç™»éŒ²</button>
                <button class="btn btn-success" onclick="runDeviceSimulation()">ãƒ‡ãƒã‚¤ã‚¹å‹•ä½œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
                <button class="btn btn-danger" onclick="clearDeviceLog()">ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="device-progress"></div>
            </div>
            <div class="log-output" id="device-log"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ”„ çµ±åˆé€šä¿¡ãƒ†ã‚¹ãƒˆ</h2>
            <div class="test-controls">
                <button class="btn btn-success" onclick="runIntegratedTest()" id="integrated-test-btn">çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
                <button class="btn btn-danger" onclick="clearIntegratedLog()">ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="integrated-progress"></div>
            </div>
            <div class="log-output" id="integrated-log"></div>
        </div>

        <div class="test-grid">
            <div class="test-card">
                <h3>ğŸ“Š ãƒ†ã‚¹ãƒˆçµ±è¨ˆ</h3>
                <div id="test-stats">
                    <p>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ: <span id="frontend-stats">æœªå®Ÿè¡Œ</span></p>
                    <p>ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆ: <span id="device-stats">æœªå®Ÿè¡Œ</span></p>
                    <p>çµ±åˆãƒ†ã‚¹ãƒˆ: <span id="integrated-stats">æœªå®Ÿè¡Œ</span></p>
                </div>
            </div>
            
            <div class="test-card">
                <h3>ğŸ”— ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³</h3>
                <div id="session-info">
                    <p>ã‚»ãƒƒã‚·ãƒ§ãƒ³ID: <span id="session-id">æœªä½œæˆ</span></p>
                    <p>ãƒ‡ãƒã‚¤ã‚¹æ¥ç¶š: <span id="device-connected">æœªæ¥ç¶š</span></p>
                    <p>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <span id="session-status">æœªé–‹å§‹</span></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentSessionId = null;
        const API_BASE_URL = 'https://fourdk-backend-333203798555.asia-northeast1.run.app';
        
        // ãƒ­ã‚°å‡ºåŠ›é–¢æ•°
        function logToElement(elementId, message, level = 'info') {
            const logElement = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            const icon = {
                'info': 'ğŸ“',
                'success': 'âœ…',
                'error': 'âŒ',
                'warning': 'âš ï¸'
            }[level] || 'ğŸ“';
            
            const logLine = `[${timestamp}] ${icon} ${message}\n`;
            logElement.textContent += logLine;
            logElement.scrollTop = logElement.scrollHeight;
        }

        // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°
        function updateProgress(progressId, percentage) {
            const progressFill = document.getElementById(progressId);
            progressFill.style.width = `${percentage}%`;
        }

        // ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±æ›´æ–°
        function updateSessionInfo(sessionData) {
            if (sessionData) {
                document.getElementById('session-id').textContent = sessionData.session_id || 'ä¸æ˜';
                document.getElementById('device-connected').textContent = sessionData.device_connected ? 'æ¥ç¶šæ¸ˆã¿' : 'æœªæ¥ç¶š';
                document.getElementById('session-status').textContent = sessionData.status || 'ä¸æ˜';
                currentSessionId = sessionData.session_id;
            }
        }

        // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
        async function runFrontendHealthCheck() {
            logToElement('frontend-log', 'ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯é–‹å§‹...');
            updateProgress('frontend-progress', 0);
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/health`);
                const data = await response.json();
                
                if (response.ok) {
                    logToElement('frontend-log', `ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯æˆåŠŸ: ${data.service} v${data.version}`, 'success');
                    updateProgress('frontend-progress', 100);
                } else {
                    logToElement('frontend-log', `ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å¤±æ•—: ${response.status}`, 'error');
                }
            } catch (error) {
                logToElement('frontend-log', `ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ
        async function runFrontendComprehensiveTest() {
            logToElement('frontend-log', 'åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
            updateProgress('frontend-progress', 0);
            
            const tests = [
                { name: 'ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯', func: testHealthCheck },
                { name: 'ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ', func: testSessionCreation },
                { name: 'ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±å–å¾—', func: testSessionInfo },
                { name: 'åŒæœŸãƒ‡ãƒ¼ã‚¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰', func: testSyncDataUpload },
                { name: 'ãƒ—ãƒ¬ã‚¤ãƒãƒƒã‚¯åŒæœŸ', func: testPlaybackSync },
                { name: 'ç›´æ¥ã‚³ãƒãƒ³ãƒ‰', func: testDirectCommand },
                { name: 'ãƒ“ãƒ‡ã‚ªä¸€è¦§å–å¾—', func: testVideoList }
            ];
            
            let completed = 0;
            let successful = 0;
            
            for (const test of tests) {
                logToElement('frontend-log', `${test.name}ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...`);
                
                try {
                    const result = await test.func();
                    if (result.success) {
                        logToElement('frontend-log', `${test.name}: æˆåŠŸ (${result.responseTime}ms)`, 'success');
                        successful++;
                    } else {
                        logToElement('frontend-log', `${test.name}: å¤±æ•— - ${result.error || 'Unknown error'}`, 'error');
                    }
                } catch (error) {
                    logToElement('frontend-log', `${test.name}: ã‚¨ãƒ©ãƒ¼ - ${error.message}`, 'error');
                }
                
                completed++;
                updateProgress('frontend-progress', (completed / tests.length) * 100);
                
                // å°‘ã—å¾…æ©Ÿ
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            const successRate = ((successful / tests.length) * 100).toFixed(1);
            logToElement('frontend-log', `åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆå®Œäº†: ${successful}/${tests.length} æˆåŠŸ (${successRate}%)`, successful === tests.length ? 'success' : 'warning');
            
            // çµ±è¨ˆæ›´æ–°
            document.getElementById('frontend-stats').textContent = `${successful}/${tests.length} æˆåŠŸ (${successRate}%)`;
        }

        // å€‹åˆ¥ãƒ†ã‚¹ãƒˆé–¢æ•°
        async function testHealthCheck() {
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE_URL}/api/health`);
                const data = await response.json();
                return {
                    success: response.ok,
                    responseTime: Math.round(performance.now() - start),
                    data: data
                };
            } catch (error) {
                return {
                    success: false,
                    responseTime: Math.round(performance.now() - start),
                    error: error.message
                };
            }
        }

        async function testSessionCreation() {
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE_URL}/api/sessions`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'User-Agent': 'Frontend-TestClient/1.0.0'
                    },
                    body: JSON.stringify({
                        product_code: 'DH001',
                        capabilities: ['VIBRATION', 'SCENT', 'MOTION'],
                        device_info: {
                            version: '1.0.0',
                            ip_address: '192.168.1.100'
                        }
                    })
                });
                
                const data = await response.json();
                
                if (response.ok && data.session_id) {
                    updateSessionInfo(data);
                }
                
                return {
                    success: response.ok,
                    responseTime: Math.round(performance.now() - start),
                    data: data
                };
            } catch (error) {
                return {
                    success: false,
                    responseTime: Math.round(performance.now() - start),
                    error: error.message
                };
            }
        }

        async function testSessionInfo() {
            if (!currentSessionId) {
                return { success: false, error: 'ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãŒæœªè¨­å®š' };
            }
            
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE_URL}/api/sessions/${currentSessionId}`);
                const data = await response.json();
                
                if (response.ok) {
                    updateSessionInfo(data);
                }
                
                return {
                    success: response.ok,
                    responseTime: Math.round(performance.now() - start),
                    data: data
                };
            } catch (error) {
                return {
                    success: false,
                    responseTime: Math.round(performance.now() - start),
                    error: error.message
                };
            }
        }

        async function testSyncDataUpload() {
            if (!currentSessionId) {
                return { success: false, error: 'ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãŒæœªè¨­å®š' };
            }
            
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE_URL}/api/sessions/${currentSessionId}/sync-data`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        video_id: 'test_video_001',
                        sync_data: [
                            {
                                timestamp: 1000,
                                effects: [{ type: 'vibration', intensity: 75 }]
                            }
                        ]
                    })
                });
                
                const data = await response.json();
                
                return {
                    success: response.ok,
                    responseTime: Math.round(performance.now() - start),
                    data: data
                };
            } catch (error) {
                return {
                    success: false,
                    responseTime: Math.round(performance.now() - start),
                    error: error.message
                };
            }
        }

        async function testPlaybackSync() {
            if (!currentSessionId) {
                return { success: false, error: 'ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãŒæœªè¨­å®š' };
            }
            
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE_URL}/api/sessions/${currentSessionId}/playback-sync`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        video_id: 'test_video_001',
                        current_time: 15.5,
                        playback_rate: 1.0,
                        is_playing: true
                    })
                });
                
                const data = await response.json();
                
                return {
                    success: response.ok,
                    responseTime: Math.round(performance.now() - start),
                    data: data
                };
            } catch (error) {
                return {
                    success: false,
                    responseTime: Math.round(performance.now() - start),
                    error: error.message
                };
            }
        }

        async function testDirectCommand() {
            if (!currentSessionId) {
                return { success: false, error: 'ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãŒæœªè¨­å®š' };
            }
            
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE_URL}/api/sessions/${currentSessionId}/direct-command`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        command_type: 'vibration',
                        intensity: 85,
                        duration: 2000,
                        video_time: 30.2
                    })
                });
                
                const data = await response.json();
                
                return {
                    success: response.ok,
                    responseTime: Math.round(performance.now() - start),
                    data: data
                };
            } catch (error) {
                return {
                    success: false,
                    responseTime: Math.round(performance.now() - start),
                    error: error.message
                };
            }
        }

        async function testVideoList() {
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE_URL}/api/videos`);
                const data = await response.json();
                
                return {
                    success: response.ok,
                    responseTime: Math.round(performance.now() - start),
                    data: data
                };
            } catch (error) {
                return {
                    success: false,
                    responseTime: Math.round(performance.now() - start),
                    error: error.message
                };
            }
        }

        // ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆé–¢æ•°
        async function runDeviceRegistration() {
            logToElement('device-log', 'ãƒ‡ãƒã‚¤ã‚¹ç™»éŒ²ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹...', 'info');
            updateProgress('device-progress', 25);
            
            try {
                const result = await testSessionCreation();
                
                if (result.success) {
                    logToElement('device-log', `ãƒ‡ãƒã‚¤ã‚¹ç™»éŒ²æˆåŠŸ: ã‚»ãƒƒã‚·ãƒ§ãƒ³ ${result.data.session_id}`, 'success');
                    updateProgress('device-progress', 100);
                    document.getElementById('device-stats').textContent = 'ç™»éŒ²æˆåŠŸ';
                } else {
                    logToElement('device-log', `ãƒ‡ãƒã‚¤ã‚¹ç™»éŒ²å¤±æ•—: ${result.error}`, 'error');
                    document.getElementById('device-stats').textContent = 'ç™»éŒ²å¤±æ•—';
                }
            } catch (error) {
                logToElement('device-log', `ãƒ‡ãƒã‚¤ã‚¹ç™»éŒ²ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        async function runDeviceSimulation() {
            if (!currentSessionId) {
                logToElement('device-log', 'ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å…ˆã«ãƒ‡ãƒã‚¤ã‚¹ç™»éŒ²ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚', 'warning');
                return;
            }
            
            logToElement('device-log', 'ãƒ‡ãƒã‚¤ã‚¹å‹•ä½œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹...', 'info');
            updateProgress('device-progress', 0);
            
            const actions = [
                'æŒ¯å‹•ã‚¢ã‚¯ãƒãƒ¥ã‚¨ãƒ¼ã‚¿ãƒ¼æº–å‚™',
                'æŒ¯å‹•å®Ÿè¡Œ (å¼·åº¦75%)',
                'ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ã‚¯ãƒãƒ¥ã‚¨ãƒ¼ã‚¿ãƒ¼æº–å‚™', 
                'ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ (è§’åº¦45åº¦)',
                'é¦™ã‚Šã‚¢ã‚¯ãƒãƒ¥ã‚¨ãƒ¼ã‚¿ãƒ¼æº–å‚™',
                'é¦™ã‚Šæ”¾å‡º (ã‚·ãƒˆãƒ©ã‚¹)',
                'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å ±å‘Šé€ä¿¡'
            ];
            
            for (let i = 0; i < actions.length; i++) {
                const action = actions[i];
                logToElement('device-log', `ğŸ® ${action}...`);
                
                // å®Ÿè¡Œã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                logToElement('device-log', `âœ… ${action} å®Œäº†`, 'success');
                updateProgress('device-progress', ((i + 1) / actions.length) * 100);
                
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            logToElement('device-log', 'ãƒ‡ãƒã‚¤ã‚¹å‹•ä½œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†', 'success');
            document.getElementById('device-stats').textContent = 'ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†';
        }

        // çµ±åˆãƒ†ã‚¹ãƒˆ
        async function runIntegratedTest() {
            const btn = document.getElementById('integrated-test-btn');
            btn.disabled = true;
            
            logToElement('integrated-log', 'çµ±åˆé€šä¿¡ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
            updateProgress('integrated-progress', 0);
            
            try {
                // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
                logToElement('integrated-log', 'ğŸ“± ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é€šä¿¡ãƒ†ã‚¹ãƒˆ...');
                await runFrontendComprehensiveTest();
                updateProgress('integrated-progress', 50);
                
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆ
                logToElement('integrated-log', 'ğŸ¤– ãƒ‡ãƒã‚¤ã‚¹å‹•ä½œãƒ†ã‚¹ãƒˆ...');
                await runDeviceSimulation();
                updateProgress('integrated-progress', 100);
                
                logToElement('integrated-log', 'ğŸ‰ çµ±åˆé€šä¿¡ãƒ†ã‚¹ãƒˆå®Œäº†', 'success');
                document.getElementById('integrated-stats').textContent = 'ãƒ†ã‚¹ãƒˆå®Œäº†';
                
            } catch (error) {
                logToElement('integrated-log', `çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                document.getElementById('integrated-stats').textContent = 'ãƒ†ã‚¹ãƒˆå¤±æ•—';
            } finally {
                btn.disabled = false;
            }
        }

        // ãƒ­ã‚°ã‚¯ãƒªã‚¢é–¢æ•°
        function clearFrontendLog() {
            document.getElementById('frontend-log').textContent = '';
            updateProgress('frontend-progress', 0);
        }

        function clearDeviceLog() {
            document.getElementById('device-log').textContent = '';
            updateProgress('device-progress', 0);
        }

        function clearIntegratedLog() {
            document.getElementById('integrated-log').textContent = '';
            updateProgress('integrated-progress', 0);
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', function() {
            logToElement('frontend-log', '4DX@HOME ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–å®Œäº†');
            logToElement('device-log', '4DX@HOME ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼åˆæœŸåŒ–å®Œäº†');
            logToElement('integrated-log', '4DX@HOME çµ±åˆãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº†');
        });
    </script>
</body>
</html>